from inverted_index_gcp import InvertedIndex





index = InvertedIndex.read_index("small_indexes/postings_gcp","index")

trends = [5101133, 18745215, 9483388, 24615479, 12431, 37593992, 10448121, 6956596, 1497849, 286747, 59868408, 4465875, 8598331, 35673556, 27051151, 1360154, 47799755, 18968719, 44008170, 24213566, 54737654, 5339378, 187946, 26275110, 30853394, 12003767, 7043619, 67414554, 47615485, 32613098, 33367993, 34083096, 3609466, 49132107, 53356243, 28236187, 1027207, 47339470, 37779362, 37980517, 62705077, 41815118, 3524766, 37728339, 32158961, 1491100, 56313056, 3660182, 1762557, 9933471, 43959031, 38755390, 3067569, 28190146, 37670240]

trends_pls = index.read_posting_list("trends","small_indexes/postings_gcp")

trends_doc_id = [tup[0] for tup in trends_pls]

counter = 0
for t in trends:
    if t not in trends_doc_id:
        counter +=1
        print("we are fucked")


print(counter)



